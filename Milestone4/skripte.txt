skripte

---teacher-load-skript:

SELECT
    CA.COURSE_ASSIGNMENT_TERM AS TERM,
    AS.LAST_NAME,
    SUM(CA.TEACHING_HOURS) AS TEACH_LOAD
FROM SCHEMA_MAIN.COURSE_ASSIGNMENT CA
JOIN SCHEMA_MAIN.ACADEMIC_STAFF AS AS
  ON CA.ACADEMIC_STAFF_ID = AS.ACADEMIC_STAFF_ID
GROUP BY CA.COURSE_ASSIGNMENT_TERM, AS.LAST_NAME
ORDER BY CA.COURSE_ASSIGNMENT_TERM, AS.LAST_NAME;


---teacher-reduction:

SELECT
  T.TERM,
  S.LAST_NAME,
  COALESCE(W.ACADEMIC_STAFF_REDUCTION, DECIMAL(0,5,2)) AS RE_LOAD
FROM (VALUES ('WS1415'), ('SS15'), ('WS1516')) AS T(TERM)
CROSS JOIN SCHEMA_MAIN.ACADEMIC_STAFF S
LEFT JOIN SCHEMA_MAIN.ACADEMIC_STAFF_WORKLOAD W
  ON W.SEMESTER_NR = T.TERM
 AND W.ACADEMIC_STAFF_ID = S.ACADEMIC_STAFF_ID
ORDER BY T.TERM, S.LAST_NAME;

---total-load:

SELECT
    T.TERM,
    S.LAST_NAME,
    COALESCE(T.TEACH_LOAD, DECIMAL(0,5,2))
  + COALESCE(R.RE_LOAD,  DECIMAL(0,5,2)) AS TOTAL_LOAD
FROM
(
    -- teach-load
    SELECT
        CA.COURSE_ASSIGNMENT_TERM AS TERM,
        CA.ACADEMIC_STAFF_ID,
        SUM(CA.TEACHING_HOURS) AS TEACH_LOAD
    FROM SCHEMA_MAIN.COURSE_ASSIGNMENT CA
    GROUP BY
        CA.COURSE_ASSIGNMENT_TERM,
        CA.ACADEMIC_STAFF_ID
) T
JOIN SCHEMA_MAIN.ACADEMIC_STAFF S
  ON S.ACADEMIC_STAFF_ID = T.ACADEMIC_STAFF_ID
LEFT JOIN
(
    -- red-load
    SELECT
        W.SEMESTER_NR AS TERM,
        W.ACADEMIC_STAFF_ID,
        SUM(W.ACADEMIC_STAFF_REDUCTION) AS RE_LOAD
    FROM SCHEMA_MAIN.ACADEMIC_STAFF_WORKLOAD W
    GROUP BY
        W.SEMESTER_NR,
        W.ACADEMIC_STAFF_ID
) R
  ON R.TERM = T.TERM
 AND R.ACADEMIC_STAFF_ID = T.ACADEMIC_STAFF_ID
ORDER BY
    T.TERM,
    S.LAST_NAME;


-- =========================
-- per term
-- =========================
SELECT
  CA.COURSE_ASSIGNMENT_TERM AS TERM,
  COUNT(*) AS CNT
FROM SCHEMA_MAIN.COURSE_ASSIGNMENT CA
GROUP BY CA.COURSE_ASSIGNMENT_TERM
ORDER BY CA.COURSE_ASSIGNMENT_TERM;

-- =========================
-- per level  (SUBJECT_SEMESTER_LVL)
-- =========================
SELECT
  CA.COURSE_ASSIGNMENT_TERM AS TERM,
  COUNT(*) AS CNT
FROM SCHEMA_MAIN.COURSE_ASSIGNMENT CA
JOIN SCHEMA_MAIN.SUBJECT S
  ON S.SUBJECT_NR = CA.SUBJECT_NR
GROUP BY CA.COURSE_ASSIGNMENT_TERM
ORDER BY CA.COURSE_ASSIGNMENT_TERM;


-- =========================
-- per term / studyPrg (DEGREE_SHORT_NAME)
-- =========================
SELECT
  CA.COURSE_ASSIGNMENT_TERM AS TERM,
  CA.DEGREE_SHORT_NAME      AS STUDYPRG,
  COUNT(*)                  AS CNT
FROM SCHEMA_MAIN.COURSE_ASSIGNMENT CA
GROUP BY CA.COURSE_ASSIGNMENT_TERM, CA.DEGREE_SHORT_NAME
ORDER BY CA.COURSE_ASSIGNMENT_TERM, CA.DEGREE_SHORT_NAME;

-- =========================
-- count(sbjname) (Beispiel: Physik)
-- =========================
SELECT
  S.SUBJECT_NAME,
  COUNT(*) AS CNT_SBJNAME
FROM SCHEMA_MAIN.SUBJECT S
WHERE S.SUBJECT_NAME = 'Physik'
GROUP BY S.SUBJECT_NAME;
