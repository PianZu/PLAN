-- Alert for missing courses (for term WS1516)
SELECT
  pb.DEGREE_SHORT_NAME,
  pb.SUBJECT_SEMESTER_LVL,
  pb.SUBJECT_NR,
  pb.SUBJECT_NAME
FROM SCHEMA_MAIN.VW_PLANNING_BASE pb
LEFT JOIN SCHEMA_MAIN.COURSE_ASSIGNMENT ca
  ON ca.SUBJECT_NR = pb.SUBJECT_NR
 AND ca.DEGREE_SHORT_NAME = pb.DEGREE_SHORT_NAME
 AND ca.COURSE_ASSIGNMENT_TERM = 'WS1516'
WHERE ca.SUBJECT_NR IS NULL
ORDER BY pb.DEGREE_SHORT_NAME, pb.SUBJECT_SEMESTER_LVL, pb.SUBJECT_NR;
