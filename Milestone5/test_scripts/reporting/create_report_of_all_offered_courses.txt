-- Create a report of all offered courses
CREATE OR REPLACE VIEW SCHEMA_MAIN.VW_OFFERED_COURSES_REPORT AS
SELECT
  ca.COURSE_ASSIGNMENT_TERM AS TERM,
  ca.DEGREE_SHORT_NAME,
  s.SUBJECT_SEMESTER_LVL,
  ca.SUBJECT_NR,
  s.SUBJECT_NAME,
  s.SUBJECT_ELECTIVE,
  ca.TEACHING_HOURS,
  a.ACADEMIC_STAFF_ID,
  a.FIRST_NAME,
  a.LAST_NAME,
  a.IS_PROF,
  a.FACULTY_SHORT_NAME
FROM SCHEMA_MAIN.COURSE_ASSIGNMENT ca
JOIN SCHEMA_MAIN.SUBJECT s
  ON s.SUBJECT_NR = ca.SUBJECT_NR
 AND s.DEGREE_SHORT_NAME = ca.DEGREE_SHORT_NAME
JOIN SCHEMA_MAIN.ACADEMIC_STAFF a
  ON a.ACADEMIC_STAFF_ID = ca.ACADEMIC_STAFF_ID;

-- Demo output for a real term from dataset
SELECT *
FROM SCHEMA_MAIN.VW_OFFERED_COURSES_REPORT
WHERE TERM = 'WS1516'
ORDER BY DEGREE_SHORT_NAME, SUBJECT_SEMESTER_LVL, SUBJECT_NR;
